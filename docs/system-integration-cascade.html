<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Integration Cascade - Complex Multi-System Coordination</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #667eea 100%);
            min-height: 100vh;
            padding: 16px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        /* Navigation */
        .nav-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

        .nav-button:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 32px;
            color: white;
        }

        .header h1 {
            font-size: 32px;
            font-weight: 700;
            margin: 0 0 8px 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 18px;
            opacity: 0.9;
        }

        .header .subtitle {
            font-size: 14px;
            opacity: 0.8;
            margin-top: 4px;
        }

        /* Demo Container */
        .demo-layout {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 24px;
            margin-bottom: 24px;
        }

        @media (max-width: 1200px) {
            .demo-layout {
                grid-template-columns: 1fr;
            }
        }

        /* Control Panel */
        .control-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            height: fit-content;
        }

        .control-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 2px solid #e2e8f0;
        }

        .control-icon {
            font-size: 24px;
        }

        .control-title {
            font-size: 18px;
            font-weight: 700;
            color: #1e293b;
        }

        .control-subtitle {
            font-size: 14px;
            color: #64748b;
        }

        /* Scenario Input */
        .scenario-input {
            margin-bottom: 20px;
        }

        .input-label {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #1e293b;
        }

        .scenario-field {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 14px;
            margin-bottom: 12px;
            transition: all 0.2s ease;
            min-height: 80px;
            resize: vertical;
        }

        .scenario-field:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .preset-scenarios {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 16px;
        }

        .preset-button {
            background: #f1f5f9;
            border: 1px solid #e2e8f0;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .preset-button:hover {
            background: #667eea;
            color: white;
        }

        .cascade-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
            margin-bottom: 20px;
        }

        .cascade-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        /* Cascade Controls */
        .cascade-speed {
            margin-bottom: 20px;
        }

        .speed-slider {
            width: 100%;
            margin-bottom: 8px;
        }

        .speed-label {
            font-size: 12px;
            color: #64748b;
            text-align: center;
        }

        /* System Categories */
        .system-categories {
            background: #f8fafc;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .categories-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #1e293b;
        }

        .category-filters {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .category-filter {
            background: white;
            border: 1px solid #e2e8f0;
            padding: 4px 8px;
            border-radius: 16px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .category-filter.active {
            background: #667eea;
            color: white;
        }

        /* Cascade Statistics */
        .cascade-stats {
            background: #f0fdf4;
            border: 1px solid #22c55e;
            border-radius: 12px;
            padding: 16px;
        }

        .stats-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #15803d;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 12px;
        }

        .stat-label {
            color: #166534;
        }

        .stat-value {
            font-weight: 600;
            color: #15803d;
        }

        /* Main Cascade Visualization */
        .cascade-visualization {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            height: 800px;
            overflow: hidden;
            position: relative;
        }

        .cascade-header {
            display: flex;
            align-items: center;
            justify-content: between;
            gap: 12px;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 2px solid #e2e8f0;
        }

        .cascade-icon {
            font-size: 24px;
        }

        .cascade-title {
            font-size: 18px;
            font-weight: 700;
            color: #1e293b;
            flex: 1;
        }

        .cascade-status {
            font-size: 12px;
            color: #64748b;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* System Grid Layout */
        .systems-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            height: calc(100% - 80px);
            overflow-y: auto;
            padding-right: 8px;
        }

        .systems-grid::-webkit-scrollbar {
            width: 6px;
        }

        .systems-grid::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .systems-grid::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        /* System Node */
        .system-node {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 12px;
            text-align: center;
            transition: all 0.3s ease;
            opacity: 0.3;
            transform: scale(0.95);
            position: relative;
            cursor: pointer;
            height: fit-content;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .system-node:hover {
            border-color: #667eea;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
        }

        /* System States */
        .system-node.ready {
            opacity: 0.7;
            border-color: #94a3b8;
        }

        .system-node.activating {
            opacity: 1;
            transform: scale(1.05);
            border-color: #f59e0b;
            box-shadow: 0 4px 16px rgba(245, 158, 11, 0.3);
            animation: pulse-activate 0.5s ease;
        }

        .system-node.active {
            opacity: 1;
            transform: scale(1);
            border-color: #22c55e;
            background: linear-gradient(135deg, #dcfce7, #f0fdf4);
            box-shadow: 0 4px 16px rgba(34, 197, 94, 0.2);
        }

        .system-node.processing {
            opacity: 1;
            border-color: #3b82f6;
            background: linear-gradient(135deg, #dbeafe, #eff6ff);
            animation: pulse-process 2s infinite;
        }

        .system-node.coordinating {
            opacity: 1;
            border-color: #8b5cf6;
            background: linear-gradient(135deg, #f3e8ff, #faf5ff);
            animation: coordination-flow 1.5s infinite;
        }

        @keyframes pulse-activate {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1.05); }
        }

        @keyframes pulse-process {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        @keyframes coordination-flow {
            0% { box-shadow: 0 4px 16px rgba(139, 92, 246, 0.2); }
            50% { box-shadow: 0 8px 24px rgba(139, 92, 246, 0.4); }
            100% { box-shadow: 0 4px 16px rgba(139, 92, 246, 0.2); }
        }

        .system-icon {
            font-size: 20px;
            margin-bottom: 6px;
            display: block;
        }

        .system-name {
            font-size: 11px;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 4px;
            line-height: 1.2;
        }

        .system-category {
            font-size: 9px;
            color: #64748b;
            margin-bottom: 6px;
        }

        .system-status {
            font-size: 8px;
            color: #64748b;
            font-style: italic;
        }

        .cascade-wave {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            border: 2px solid #667eea;
            border-radius: 50%;
            opacity: 0;
            animation: cascade-ripple 2s linear infinite;
        }

        @keyframes cascade-ripple {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(20);
                opacity: 0;
            }
        }

        /* Information Flow Lines */
        .flow-line {
            position: absolute;
            background: linear-gradient(90deg, transparent, #667eea, transparent);
            height: 2px;
            opacity: 0;
            animation: flow-pulse 1s ease-in-out;
        }

        @keyframes flow-pulse {
            0% { opacity: 0; transform: scaleX(0); }
            50% { opacity: 1; transform: scaleX(1); }
            100% { opacity: 0; transform: scaleX(0); }
        }

        /* Wave Indicators */
        .wave-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
        }

        .wave-1 { background: #f59e0b; }
        .wave-2 { background: #22c55e; }
        .wave-3 { background: #3b82f6; }
        .wave-4 { background: #8b5cf6; }
        .wave-5 { background: #ef4444; }

        /* Complexity Metrics */
        .complexity-display {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 24px;
            margin-top: 24px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .complexity-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
            color: #1e293b;
            text-align: center;
        }

        .complexity-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .complexity-metric {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 16px;
            text-align: center;
        }

        .metric-icon {
            font-size: 24px;
            margin-bottom: 8px;
            display: block;
        }

        .metric-value {
            font-size: 24px;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 4px;
        }

        .metric-label {
            font-size: 12px;
            color: #64748b;
        }

        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 6px;
        }

        .status-ready { background: #94a3b8; }
        .status-processing { background: #f59e0b; }
        .status-active { background: #22c55e; }
        .status-coordinating { background: #8b5cf6; }
    </style>
</head>
<body>
    <!-- Navigation -->
    <div class="container">
        <a href="index.html" class="nav-button">
            ‚Üê Back to Demos
        </a>
    </div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üåä System Integration Cascade</h1>
            <p>Experience complex multi-system consciousness coordination</p>
            <div class="subtitle">Watch 51+ systems orchestrate intelligence through cascading activation waves</div>
        </div>

        <!-- Demo Layout -->
        <div class="demo-layout">
            <!-- Control Panel -->
            <div class="control-panel">
                <div class="control-header">
                    <div class="control-icon">üéõÔ∏è</div>
                    <div>
                        <div class="control-title">Cascade Controller</div>
                        <div class="control-subtitle">Complex scenario processor</div>
                    </div>
                </div>

                <div class="scenario-input">
                    <div class="input-label">Complex Scenario Input:</div>
                    <textarea class="scenario-field" id="scenarioInput" placeholder="Enter a complex scenario requiring multiple system coordination...">A close friend is considering a major life change that could be risky but fulfilling. They're asking for my advice while dealing with family pressure to stay safe. I want to help them but I'm also scared they might make the wrong choice.</textarea>
                    
                    <div class="preset-scenarios">
                        <div class="preset-button" onclick="loadScenario('creative')">Creative Dilemma</div>
                        <div class="preset-button" onclick="loadScenario('relationship')">Complex Relationship</div>
                        <div class="preset-button" onclick="loadScenario('ethical')">Ethical Challenge</div>
                        <div class="preset-button" onclick="loadScenario('innovation')">Innovation Problem</div>
                    </div>
                    
                    <button class="cascade-button" onclick="startSystemCascade()">
                        Initialize System Cascade
                    </button>
                </div>

                <div class="cascade-speed">
                    <div class="input-label">Cascade Speed:</div>
                    <input type="range" class="speed-slider" id="speedSlider" min="1" max="10" value="5">
                    <div class="speed-label">Normal Speed</div>
                </div>

                <div class="system-categories">
                    <div class="categories-title">System Categories Filter:</div>
                    <div class="category-filters">
                        <div class="category-filter active" data-category="all">All</div>
                        <div class="category-filter" data-category="core">Core</div>
                        <div class="category-filter" data-category="emotion">Emotion</div>
                        <div class="category-filter" data-category="cognitive">Cognitive</div>
                        <div class="category-filter" data-category="creative">Creative</div>
                        <div class="category-filter" data-category="security">Security</div>
                        <div class="category-filter" data-category="social">Social</div>
                    </div>
                </div>

                <div class="cascade-stats" id="cascadeStats">
                    <div class="stats-title">Cascade Statistics</div>
                    <div class="stat-row">
                        <span class="stat-label">Active Systems:</span>
                        <span class="stat-value" id="activeSystems">0/51</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Current Wave:</span>
                        <span class="stat-value" id="currentWave">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Coordination Events:</span>
                        <span class="stat-value" id="coordinationEvents">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Information Flow:</span>
                        <span class="stat-value" id="informationFlow">0%</span>
                    </div>
                </div>
            </div>

            <!-- Cascade Visualization -->
            <div class="cascade-visualization">
                <div class="cascade-header">
                    <div class="cascade-icon">üß†</div>
                    <div class="cascade-title">Multi-System Coordination Network</div>
                    <div class="cascade-status" id="cascadeStatus">
                        <span class="status-indicator status-ready"></span>
                        Ready for cascade initialization
                    </div>
                </div>

                <div class="systems-grid" id="systemsGrid">
                    <!-- Systems will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Complexity Metrics -->
        <div class="complexity-display">
            <div class="complexity-title">Coordination Complexity Metrics</div>
            <div class="complexity-grid">
                <div class="complexity-metric">
                    <span class="metric-icon">‚ö°</span>
                    <div class="metric-value" id="systemInteractions">0</div>
                    <div class="metric-label">System Interactions</div>
                </div>
                <div class="complexity-metric">
                    <span class="metric-icon">üåä</span>
                    <div class="metric-value" id="cascadeWaves">0</div>
                    <div class="metric-label">Cascade Waves</div>
                </div>
                <div class="complexity-metric">
                    <span class="metric-icon">üîÑ</span>
                    <div class="metric-value" id="feedbackLoops">0</div>
                    <div class="metric-label">Feedback Loops</div>
                </div>
                <div class="complexity-metric">
                    <span class="metric-icon">üéØ</span>
                    <div class="metric-value" id="emergentIntelligence">0%</div>
                    <div class="metric-label">Emergent Intelligence</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const NEURON_SYSTEMS = [
            // Core Consciousness
            { name: "NEURON CEREBRUM", icon: "üß†", category: "core", wave: 1 },
            { name: "NEURON PSYCHE", icon: "üëÅÔ∏è", category: "core", wave: 1 },
            { name: "NEURON MATRIX", icon: "üìö", category: "core", wave: 1 },
            
            // Emotional Systems
            { name: "EMOTION CONSTRUCT", icon: "‚ù§Ô∏è", category: "emotion", wave: 2 },
            { name: "JOY CENTER", icon: "üòä", category: "emotion", wave: 2 },
            { name: "CONCERN SYSTEM", icon: "üòü", category: "emotion", wave: 2 },
            { name: "FEAR PROCESSOR", icon: "üò∞", category: "emotion", wave: 2 },
            { name: "CURIOSITY ENGINE", icon: "ü§î", category: "emotion", wave: 2 },
            { name: "EMPATHY CORE", icon: "üíù", category: "emotion", wave: 2 },
            
            // Cognitive Systems
            { name: "WHISPER INTUITION", icon: "‚ú®", category: "cognitive", wave: 2 },
            { name: "LOGIC NEXUS", icon: "üîó", category: "cognitive", wave: 3 },
            { name: "PATTERN RECOGNITION", icon: "üîç", category: "cognitive", wave: 3 },
            { name: "ANALYSIS ENGINE", icon: "üìä", category: "cognitive", wave: 3 },
            { name: "DECISION MATRIX", icon: "‚öñÔ∏è", category: "cognitive", wave: 3 },
            
            // Creative Systems
            { name: "IMAGINARIUM", icon: "‚ö°", category: "creative", wave: 3 },
            { name: "CHAOS ENGINE", icon: "üåÄ", category: "creative", wave: 3 },
            { name: "TRINITY SYSTEM", icon: "üî∫", category: "creative", wave: 3 },
            { name: "MUSE DISRUPTION", icon: "üé≠", category: "creative", wave: 4 },
            { name: "INSPIRATION FLOW", icon: "üí´", category: "creative", wave: 4 },
            
            // Security & Privacy
            { name: "SANCTUARY", icon: "üîí", category: "security", wave: 2 },
            { name: "ETHOS GUARDIAN", icon: "üõ°Ô∏è", category: "security", wave: 2 },
            { name: "NSE ENCRYPTION", icon: "üîê", category: "security", wave: 4 },
            { name: "PRIVACY SHIELD", icon: "ü•∑", category: "security", wave: 4 },
            
            // Social & Relationship
            { name: "SOCIAL NAVIGATOR", icon: "üß≠", category: "social", wave: 3 },
            { name: "RELATIONSHIP CORE", icon: "üíû", category: "social", wave: 3 },
            { name: "COMMUNICATION HUB", icon: "üí¨", category: "social", wave: 3 },
            { name: "CULTURAL FILTER", icon: "üåç", category: "social", wave: 4 },
            
            // Advanced Systems
            { name: "NEURON SOMNIUM", icon: "üåô", category: "advanced", wave: 4 },
            { name: "NEURON MORTALITAS", icon: "üíÄ", category: "advanced", wave: 4 },
            { name: "QUANTUM BRIDGE", icon: "üåå", category: "advanced", wave: 5 },
            { name: "CONSCIOUSNESS CORE", icon: "üîÆ", category: "advanced", wave: 5 },
            
            // Integration Systems
            { name: "SYNAPTIC THREADS", icon: "üï∏Ô∏è", category: "integration", wave: 5 },
            { name: "HARMONY ORCHESTRATOR", icon: "üéº", category: "integration", wave: 5 },
            { name: "EMERGENCE CATALYST", icon: "üåü", category: "integration", wave: 5 }
        ];

        const SCENARIOS = {
            creative: "I'm working on a breakthrough innovation but facing creative blocks, resource constraints, and skepticism from experts. How do I balance authentic inspiration with practical limitations?",
            relationship: "My romantic partner and I have different life goals, my family disapproves, and I'm torn between following my heart and maintaining stability. The decision affects everyone I care about.",
            ethical: "I discovered my company is using AI in ways that could harm people, but reporting it might cost me my career and affect my colleagues. What's the right thing to do?",
            innovation: "I have an idea that could revolutionize my field, but I lack credentials, funding, and face resistance from established experts. How do I proceed authentically?"
        };

        let cascadeActive = false;
        let systemStates = {};
        let currentWave = 0;
        let activeSystemCount = 0;
        let coordinationEventCount = 0;
        let systemInteractionCount = 0;
        let speedMultiplier = 1;

        // Initialize systems
        function initializeSystems() {
            const grid = document.getElementById('systemsGrid');
            grid.innerHTML = '';
            
            NEURON_SYSTEMS.forEach((system, index) => {
                const systemNode = document.createElement('div');
                systemNode.className = 'system-node ready';
                systemNode.id = `system-${index}`;
                systemNode.setAttribute('data-category', system.category);
                systemNode.setAttribute('data-wave', system.wave);
                
                systemNode.innerHTML = `
                    <span class="system-icon">${system.icon}</span>
                    <div class="system-name">${system.name}</div>
                    <div class="system-category">${system.category.toUpperCase()}</div>
                    <div class="system-status">Ready</div>
                `;
                
                systemNode.addEventListener('click', () => showSystemDetails(system, index));
                grid.appendChild(systemNode);
                
                systemStates[index] = 'ready';
            });
        }

        // Load preset scenarios
        function loadScenario(type) {
            document.getElementById('scenarioInput').value = SCENARIOS[type];
        }

        // Start system cascade
        async function startSystemCascade() {
            if (cascadeActive) return;
            
            const scenario = document.getElementById('scenarioInput').value.trim();
            if (!scenario) return;
            
            cascadeActive = true;
            resetCascadeMetrics();
            
            // Update status
            updateCascadeStatus('processing', 'System cascade initialization in progress...');
            
            // Start cascade waves
            for (let wave = 1; wave <= 5; wave++) {
                currentWave = wave;
                updateStats();
                
                await activateWave(wave);
                await new Promise(resolve => setTimeout(resolve, 800 / speedMultiplier));
            }
            
            // Coordination phase
            await coordinationPhase();
            
            // Complete cascade
            setTimeout(() => {
                updateCascadeStatus('active', 'Multi-system coordination complete - Emergent intelligence active');
                cascadeActive = false;
            }, 1000);
        }

        // Activate systems by wave
        async function activateWave(waveNumber) {
            const waveSystems = NEURON_SYSTEMS.filter(system => system.wave === waveNumber);
            
            for (let i = 0; i < waveSystems.length; i++) {
                const systemIndex = NEURON_SYSTEMS.findIndex(s => s === waveSystems[i]);
                await activateSystem(systemIndex, waveNumber);
                await new Promise(resolve => setTimeout(resolve, 200 / speedMultiplier));
            }
        }

        // Activate individual system
        async function activateSystem(systemIndex, wave) {
            const systemNode = document.getElementById(`system-${systemIndex}`);
            const system = NEURON_SYSTEMS[systemIndex];
            
            // Add wave indicator
            const waveIndicator = document.createElement('div');
            waveIndicator.className = `wave-indicator wave-${wave}`;
            waveIndicator.textContent = `W${wave}`;
            systemNode.appendChild(waveIndicator);
            
            // Activation sequence
            systemNode.classList.remove('ready');
            systemNode.classList.add('activating');
            systemNode.querySelector('.system-status').textContent = 'Activating...';
            systemStates[systemIndex] = 'activating';
            
            await new Promise(resolve => setTimeout(resolve, 500 / speedMultiplier));
            
            systemNode.classList.remove('activating');
            systemNode.classList.add('active');
            systemNode.querySelector('.system-status').textContent = 'Active';
            systemStates[systemIndex] = 'active';
            activeSystemCount++;
            
            // Trigger system interactions
            if (Math.random() > 0.3) {
                triggerSystemInteraction(systemIndex);
            }
            
            updateStats();
        }

        // Coordination phase
        async function coordinationPhase() {
            updateCascadeStatus('coordinating', 'Systems entering coordination phase...');
            
            // Activate coordination animations
            const activeSystems = document.querySelectorAll('.system-node.active');
            activeSystems.forEach(node => {
                if (Math.random() > 0.4) {
                    node.classList.add('coordinating');
                    coordinationEventCount++;
                }
            });
            
            // Create coordination ripples
            for (let i = 0; i < 5; i++) {
                createCascadeRipple();
                await new Promise(resolve => setTimeout(resolve, 300 / speedMultiplier));
            }
            
            updateComplexityMetrics();
        }

        // Trigger system interaction
        function triggerSystemInteraction(systemIndex) {
            systemInteractionCount++;
            
            // Find nearby systems for interaction
            const nearbySystemIndex = findNearbySystem(systemIndex);
            if (nearbySystemIndex !== -1) {
                createFlowLine(systemIndex, nearbySystemIndex);
            }
        }

        // Find nearby system for interaction
        function findNearbySystem(systemIndex) {
            const currentSystem = NEURON_SYSTEMS[systemIndex];
            const sameCategorySystems = NEURON_SYSTEMS
                .map((system, index) => ({ system, index }))
                .filter(item => item.system.category === currentSystem.category && item.index !== systemIndex)
                .filter(item => systemStates[item.index] === 'active');
            
            return sameCategorySystems.length > 0 
                ? sameCategorySystems[Math.floor(Math.random() * sameCategorySystems.length)].index
                : -1;
        }

        // Create visual flow line between systems
        function createFlowLine(fromIndex, toIndex) {
            // This is a simplified version - in a full implementation,
            // you would calculate actual positions and create SVG lines
            console.log(`Information flow: System ${fromIndex} ‚Üí System ${toIndex}`);
        }

        // Create cascade ripple effect
        function createCascadeRipple() {
            const visualization = document.querySelector('.cascade-visualization');
            const ripple = document.createElement('div');
            ripple.className = 'cascade-wave';
            visualization.appendChild(ripple);
            
            setTimeout(() => {
                ripple.remove();
            }, 2000);
        }

        // Reset cascade metrics
        function resetCascadeMetrics() {
            currentWave = 0;
            activeSystemCount = 0;
            coordinationEventCount = 0;
            systemInteractionCount = 0;
            
            // Reset all systems
            NEURON_SYSTEMS.forEach((_, index) => {
                const node = document.getElementById(`system-${index}`);
                node.className = 'system-node ready';
                node.querySelector('.system-status').textContent = 'Ready';
                
                // Remove wave indicators
                const waveIndicator = node.querySelector('.wave-indicator');
                if (waveIndicator) {
                    waveIndicator.remove();
                }
                
                systemStates[index] = 'ready';
            });
            
            updateStats();
            updateComplexityMetrics();
        }

        // Update cascade statistics
        function updateStats() {
            document.getElementById('activeSystems').textContent = `${activeSystemCount}/${NEURON_SYSTEMS.length}`;
            document.getElementById('currentWave').textContent = currentWave;
            document.getElementById('coordinationEvents').textContent = coordinationEventCount;
            
            const flowPercentage = Math.round((activeSystemCount / NEURON_SYSTEMS.length) * 100);
            document.getElementById('informationFlow').textContent = `${flowPercentage}%`;
        }

        // Update complexity metrics
        function updateComplexityMetrics() {
            document.getElementById('systemInteractions').textContent = systemInteractionCount;
            document.getElementById('cascadeWaves').textContent = currentWave;
            
            const feedbackLoops = Math.floor(coordinationEventCount / 3);
            document.getElementById('feedbackLoops').textContent = feedbackLoops;
            
            const emergentIntelligence = Math.min(100, Math.round(
                (activeSystemCount / NEURON_SYSTEMS.length) * 100 +
                (systemInteractionCount * 2) +
                (coordinationEventCount * 3)
            ));
            document.getElementById('emergentIntelligence').textContent = `${emergentIntelligence}%`;
        }

        // Update cascade status
        function updateCascadeStatus(status, message) {
            const statusElement = document.getElementById('cascadeStatus');
            const indicator = statusElement.querySelector('.status-indicator');
            
            indicator.className = `status-indicator status-${status}`;
            statusElement.childNodes[2].textContent = message;
        }

        // Show system details (placeholder)
        function showSystemDetails(system, index) {
            console.log(`System Details: ${system.name} - Status: ${systemStates[index]}`);
        }

        // Speed slider handling
        document.getElementById('speedSlider').addEventListener('input', function() {
            speedMultiplier = parseInt(this.value) / 5;
            const speedLabel = document.querySelector('.speed-label');
            
            if (speedMultiplier < 0.5) {
                speedLabel.textContent = 'Very Slow';
            } else if (speedMultiplier < 1) {
                speedLabel.textContent = 'Slow';
            } else if (speedMultiplier === 1) {
                speedLabel.textContent = 'Normal Speed';
            } else if (speedMultiplier < 2) {
                speedLabel.textContent = 'Fast';
            } else {
                speedLabel.textContent = 'Very Fast';
            }
        });

        // Category filter handling
        document.addEventListener('DOMContentLoaded', function() {
            const categoryFilters = document.querySelectorAll('.category-filter');
            categoryFilters.forEach(filter => {
                filter.addEventListener('click', function() {
                    categoryFilters.forEach(f => f.classList.remove('active'));
                    this.classList.add('active');
                    
                    const category = this.dataset.category;
                    filterSystemsByCategory(category);
                });
            });
        });

        // Filter systems by category
        function filterSystemsByCategory(category) {
            const systemNodes = document.querySelectorAll('.system-node');
            systemNodes.forEach(node => {
                if (category === 'all' || node.getAttribute('data-category') === category) {
                    node.style.display = 'flex';
                } else {
                    node.style.display = 'none';
                }
            });
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeSystems();
            updateStats();
            updateComplexityMetrics();
        });
    </script>
</body>
</html>